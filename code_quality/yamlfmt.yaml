parameters:
  - name: SOURCE_FOLDER
    type: string
    default: '.'

steps:
  - powershell: |
      choco install golang -y
    displayName: 'Install Go (Golang)'

  - powershell: |
      # Add Go installation bin folder to PATH
      $env:PATH += ";C:\Program Files\Go\bin;$env:USERPROFILE\go\bin"

      # Verify Go is available
      go version

      # Install yamlfmt
      go install github.com/google/yamlfmt/cmd/yamlfmt@latest

      # Verify yamlfmt installed correctly
      yamlfmt --version
    displayName: 'Install yamlfmt'

  - powershell: |
      # Run yamlfmt lint on the source folder
      yamlfmt -lint ${{ parameters.SOURCE_FOLDER }}
    displayName: 'Run yamlfmt'

