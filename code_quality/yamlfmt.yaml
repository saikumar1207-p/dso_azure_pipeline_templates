parameters:
  - name: SOURCE_FOLDER
    type: string
    default: '.'

pool:
  vmImage: 'windows-latest'

steps:
  - powershell: |
      # Confirm Go version is available
      go version

      # Install yamlfmt using go install
      go install github.com/google/yamlfmt/cmd/yamlfmt@latest

      # Add Go bin folder to PATH for this session
      $env:PATH += ";$env:USERPROFILE\go\bin"

      # Verify yamlfmt installation
      yamlfmt --version
    displayName: 'Install yamlfmt'

  - powershell: |
      # Run yamlfmt lint on the source folder
      yamlfmt -lint ${{ parameters.SOURCE_FOLDER }}
    displayName: 'Run yamlfmt'
